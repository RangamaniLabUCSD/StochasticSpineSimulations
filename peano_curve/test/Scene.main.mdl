/* DEFINE PARAMETERS */
iters = 5000
dt = 1e-06
Na = 6.0221415e23
area = 1.2441e-11
dx = 5e-7
dc = 5e-6
cl = 2e-5
/*path = "/Users/mvhsan/Papers/StochasticSpineSimulations/peano_curve/test"*/

ITERATIONS = iters / 10
TIME_STEP = dt
VACANCY_SEARCH_DISTANCE = 10

SURFACE_GRID_DENSITY = 10000
ACCURATE_3D_REACTIONS = TRUE
CENTER_MOLECULES_ON_GRID = FALSE
MICROSCOPIC_REVERSIBILITY = OFF

NOTIFICATIONS
{
   PROBABILITY_REPORT = ON
   DIFFUSION_CONSTANT_REPORT = BRIEF
   FILE_OUTPUT_REPORT = OFF
   FINAL_SUMMARY = ON
   ITERATION_REPORT = ON
   PARTITION_LOCATION_REPORT = OFF
   VARYING_PROBABILITY_REPORT = ON
   PROGRESS_REPORT = ON
   RELEASE_EVENT_REPORT = ON
   MOLECULE_COLLISION_REPORT = OFF
}

WARNINGS
{
   DEGENERATE_POLYGONS = WARNING
   NEGATIVE_DIFFUSION_CONSTANT = WARNING
   MISSING_SURFACE_ORIENTATION = ERROR
   NEGATIVE_REACTION_RATE = WARNING
   USELESS_VOLUME_ORIENTATION = WARNING
   HIGH_REACTION_PROBABILITY = IGNORED
   LIFETIME_TOO_SHORT = WARNING
   LIFETIME_THRESHOLD = 50
   MISSED_REACTIONS = WARNING
   MISSED_REACTION_THRESHOLD = 0.00100000004749745
}

DEFINE_MOLECULES
{
  vm
  {
    DIFFUSION_CONSTANT_3D = dc
  }
}

DEFINE_SURFACE_CLASSES
{
  clamp
  {
    CLAMP_CONCENTRATION vm, = cl
  }
  absorb
  {
    ABSORPTIVE = ALL_VOLUME_MOLECULES;
  }
}

cylinder POLYGON_LIST
{
  VERTEX_LIST
  {
    [ -1, 0.199999988079071, -7.54979012640433e-08 ]
    [ 1, 0.199999988079071, 7.54979012640433e-08 ]
    [ -1, 0.196157038211823, -0.0390181355178356 ]
    [ 1, 0.196157038211823, -0.0390179865062237 ]
    [ -1, 0.18477588891983, -0.0765367597341537 ]
    [ 1, 0.18477588891983, -0.0765366107225418 ]
    [ -1, 0.166293904185295, -0.111114114522934 ]
    [ 1, 0.166293904185295, -0.111113965511322 ]
    [ -1, 0.141421347856522, -0.141421422362328 ]
    [ 1, 0.141421347856522, -0.141421273350716 ]
    [ -1, 0.111114032566547, -0.166293993592262 ]
    [ 1, 0.111114032566547, -0.16629384458065 ]
    [ -1, 0.0765366777777672, -0.184775963425636 ]
    [ 1, 0.0765366777777672, -0.184775814414024 ]
    [ -1, 0.0390180684626102, -0.196157112717628 ]
    [ 1, 0.0390180684626102, -0.196156963706017 ]
    [ -1, 1.50995784764518e-08, -0.200000062584877 ]
    [ 1, 1.50995784764518e-08, -0.199999913573265 ]
    [ -1, -0.0390180386602879, -0.19615712761879 ]
    [ 1, -0.0390180386602879, -0.196156978607178 ]
    [ -1, -0.0765366479754448, -0.184775978326797 ]
    [ 1, -0.0765366479754448, -0.184775829315186 ]
    [ -1, -0.111114032566547, -0.166293993592262 ]
    [ 1, -0.111114032566547, -0.16629384458065 ]
    [ -1, -0.141421347856522, -0.141421422362328 ]
    [ 1, -0.141421347856522, -0.141421273350716 ]
    [ -1, -0.166293919086456, -0.111114107072353 ]
    [ 1, -0.166293919086456, -0.111113958060741 ]
    [ -1, -0.184775918722153, -0.0765367224812508 ]
    [ 1, -0.184775918722153, -0.0765365734696388 ]
    [ -1, -0.196157053112984, -0.039018090814352 ]
    [ 1, -0.196157053112984, -0.0390179418027401 ]
    [ -1, -0.199999988079071, -1.03296287079502e-08 ]
    [ 1, -0.199999988079071, 1.40666173820136e-07 ]
    [ -1, -0.196157023310661, 0.0390180684626102 ]
    [ 1, -0.196157023310661, 0.0390182174742222 ]
    [ -1, -0.184775859117508, 0.0765366926789284 ]
    [ 1, -0.184775859117508, 0.0765368416905403 ]
    [ -1, -0.16629384458065, 0.11111406236887 ]
    [ 1, -0.16629384458065, 0.111114211380482 ]
    [ -1, -0.141421258449554, 0.141421362757683 ]
    [ 1, -0.141421258449554, 0.141421511769295 ]
    [ -1, -0.111113920807838, 0.166293919086456 ]
    [ 1, -0.111113920807838, 0.166294068098068 ]
    [ -1, -0.0765365287661552, 0.18477588891983 ]
    [ 1, -0.0765365287661552, 0.184776037931442 ]
    [ -1, -0.0390178896486759, 0.196156993508339 ]
    [ 1, -0.0390178896486759, 0.196157142519951 ]
    [ -1, 1.93119817026854e-07, 0.199999913573265 ]
    [ 1, 1.93119817026854e-07, 0.200000062584877 ]
    [ -1, 0.0390182696282864, 0.196156933903694 ]
    [ 1, 0.0390182696282864, 0.196157082915306 ]
    [ -1, 0.0765368863940239, 0.184775725007057 ]
    [ 1, 0.0765368863940239, 0.184775874018669 ]
    [ -1, 0.111114248633385, 0.1662937104702 ]
    [ 1, 0.111114248633385, 0.166293859481812 ]
    [ -1, 0.141421526670456, 0.141421094536781 ]
    [ 1, 0.141421526670456, 0.141421243548393 ]
    [ -1, 0.166294068098068, 0.111113741993904 ]
    [ 1, 0.166294068098068, 0.111113891005516 ]
    [ -1, 0.18477600812912, 0.0765363350510597 ]
    [ 1, 0.18477600812912, 0.0765364840626717 ]
    [ -1, 0.196157097816467, 0.0390176884829998 ]
    [ 1, 0.196157097816467, 0.0390178374946117 ]
  }
  ELEMENT_CONNECTIONS
  {
    [ 1, 2, 0 ]
    [ 3, 4, 2 ]
    [ 5, 6, 4 ]
    [ 7, 8, 6 ]
    [ 9, 10, 8 ]
    [ 11, 12, 10 ]
    [ 13, 14, 12 ]
    [ 15, 16, 14 ]
    [ 17, 18, 16 ]
    [ 19, 20, 18 ]
    [ 21, 22, 20 ]
    [ 23, 24, 22 ]
    [ 25, 26, 24 ]
    [ 27, 28, 26 ]
    [ 29, 30, 28 ]
    [ 31, 32, 30 ]
    [ 33, 34, 32 ]
    [ 35, 36, 34 ]
    [ 37, 38, 36 ]
    [ 39, 40, 38 ]
    [ 41, 42, 40 ]
    [ 43, 44, 42 ]
    [ 45, 46, 44 ]
    [ 47, 48, 46 ]
    [ 49, 50, 48 ]
    [ 51, 52, 50 ]
    [ 53, 54, 52 ]
    [ 55, 56, 54 ]
    [ 57, 58, 56 ]
    [ 59, 60, 58 ]
    [ 53, 37, 21 ]
    [ 61, 62, 60 ]
    [ 63, 0, 62 ]
    [ 14, 30, 46 ]
    [ 1, 3, 2 ]
    [ 3, 5, 4 ]
    [ 5, 7, 6 ]
    [ 7, 9, 8 ]
    [ 9, 11, 10 ]
    [ 11, 13, 12 ]
    [ 13, 15, 14 ]
    [ 15, 17, 16 ]
    [ 17, 19, 18 ]
    [ 19, 21, 20 ]
    [ 21, 23, 22 ]
    [ 23, 25, 24 ]
    [ 25, 27, 26 ]
    [ 27, 29, 28 ]
    [ 29, 31, 30 ]
    [ 31, 33, 32 ]
    [ 33, 35, 34 ]
    [ 35, 37, 36 ]
    [ 37, 39, 38 ]
    [ 39, 41, 40 ]
    [ 41, 43, 42 ]
    [ 43, 45, 44 ]
    [ 45, 47, 46 ]
    [ 47, 49, 48 ]
    [ 49, 51, 50 ]
    [ 51, 53, 52 ]
    [ 53, 55, 54 ]
    [ 55, 57, 56 ]
    [ 57, 59, 58 ]
    [ 59, 61, 60 ]
    [ 5, 3, 1 ]
    [ 1, 63, 5 ]
    [ 63, 61, 5 ]
    [ 61, 59, 57 ]
    [ 57, 55, 53 ]
    [ 53, 51, 49 ]
    [ 49, 47, 53 ]
    [ 47, 45, 53 ]
    [ 45, 43, 37 ]
    [ 43, 41, 37 ]
    [ 41, 39, 37 ]
    [ 37, 35, 33 ]
    [ 33, 31, 29 ]
    [ 29, 27, 25 ]
    [ 25, 23, 21 ]
    [ 21, 19, 17 ]
    [ 17, 15, 21 ]
    [ 15, 13, 21 ]
    [ 13, 11, 9 ]
    [ 9, 7, 5 ]
    [ 61, 57, 5 ]
    [ 57, 53, 5 ]
    [ 37, 33, 21 ]
    [ 33, 29, 21 ]
    [ 29, 25, 21 ]
    [ 13, 9, 21 ]
    [ 9, 5, 21 ]
    [ 53, 45, 37 ]
    [ 5, 53, 21 ]
    [ 61, 63, 62 ]
    [ 63, 1, 0 ]
    [ 62, 0, 2 ]
    [ 2, 4, 6 ]
    [ 6, 8, 10 ]
    [ 10, 12, 6 ]
    [ 12, 14, 6 ]
    [ 14, 16, 18 ]
    [ 18, 20, 14 ]
    [ 20, 22, 14 ]
    [ 22, 24, 30 ]
    [ 24, 26, 30 ]
    [ 26, 28, 30 ]
    [ 30, 32, 34 ]
    [ 34, 36, 38 ]
    [ 38, 40, 42 ]
    [ 42, 44, 46 ]
    [ 46, 48, 50 ]
    [ 50, 52, 54 ]
    [ 54, 56, 62 ]
    [ 56, 58, 62 ]
    [ 58, 60, 62 ]
    [ 62, 2, 6 ]
    [ 30, 34, 46 ]
    [ 34, 38, 46 ]
    [ 38, 42, 46 ]
    [ 46, 50, 62 ]
    [ 50, 54, 62 ]
    [ 62, 6, 14 ]
    [ 14, 22, 30 ]
    [ 62, 14, 46 ]
  }
  DEFINE_SURFACE_REGIONS
  {
    left_end
    {
      ELEMENT_LIST = [33, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123]
    }
    right_end
    {
      ELEMENT_LIST = [30, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92]
    }
  }
}

MODIFY_SURFACE_REGIONS
{
  cylinder[left_end]
  {
    SURFACE_CLASS = clamp
  }
  cylinder[right_end]
  {
    SURFACE_CLASS = absorb
  }
}

INSTANTIATE Scene OBJECT
{
  cylinder OBJECT cylinder {}
}

sprintf(seed, "%05g", SEED)

VIZ_OUTPUT
{ 
  MODE = CELLBLENDER
  FILENAME = "./viz_data/seed_" & seed & "/Scene"
  MOLECULES
  { 
    NAME_LIST {ALL_MOLECULES}
    ITERATION_NUMBERS {ALL_DATA @ ALL_ITERATIONS}
  }
}


